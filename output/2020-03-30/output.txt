design <- FrF2( (2^(numFactors-n)), numFactors, factor.names = list(ntree = c(-1,1),   
+                                                                     mtry = c(-1,1),
+                                                                     replace = c(-1,1),
+                                                                     nodesize = c(-1,1),
+                                                                     classwt = c(-1,1),
+                                                                     cutoff = c(-1,1),
+                                                                     maxnodes = c(-1,1) ) ,  seed = 6285)
> results5 <- c()

 Sys.time()
[1] "2020-03-30 14:26:17 EDT"
> 
> for (i in 1:nrow(design)){
+   if (design$ntree[i] == -1)     {ntree <- 100} else {ntree <- 500}
+   if (design$mtry[i] == -1)      {mtry <- floor(log(ncol(df)-1))} else {mtry <- ceiling(sqrt(ncol(df)-1))}
+   if (design$replace[i] == -1)   {replace <- FALSE} else {replace <- TRUE}
+   if (design$nodesize[i] == -1)  {nodesize <- 1} else {nodesize <- floor(0.1*nrow(df))}
+   if (design$classwt[i] == -1)   {classwt <- c(1,10)} else {classwt <- c(10,1)}
+   if (design$cutoff[i] == -1)    {cutoff <- c(0.2, 1 -0.2)} else {cutoff <- c(0.8,1-0.8)}
+   if (design$maxnodes[i] == -1)  {maxnodes <- 5} else {maxnodes <- NULL}
+   
+   #cross-validation
+   createIndex <- rep(1:10, length.out = nrow(df))
+   randomIndex <- sample(createIndex)
+   
+   innerResults <- c()
+   
+   TP   <-  0
+   FN   <-  0
+   FP   <-  0
+   TN   <-  0
+   
+   for (j in 1:10){
+     
+     print(paste("fold",j,"of run", i))
+     train <- df[-which(randomIndex == j),]
+     test <-  df[ which(randomIndex == j),]
+     
+     
+     
+     RFmodel <- randomForest(x = train[,retained.predictors], y = train[,"my_res"],
+                             xtest = test[,retained.predictors], ytest = test[,"my_res"],
+                             ntree = ntree,
+                             mtry = mtry,
+                             replace = replace,
+                             nodesize = nodesize,
+                             classwt = classwt,
+                             cutoff = cutoff,
+                             maxnodes = maxnodes)
+     
+     confu <- as.data.frame(RFmodel$test$confusion)
+     
+     TP   <-  TP + confu[labels[2], labels[2]] 
+     FN   <-  FN + confu[labels[2], labels[1]]
+     FP   <-  FP + confu[labels[1], labels[2]]
+     TN   <-  TN + confu[labels[1], labels[1]]
+     
+   }
+   
+   TPR <- TP/(TP+FN)
+   TNR <- TN/(TN+FP)
+   BACC <- (TPR + TNR)/2
+   print(BACC)
+   results5 <- c(results5, BACC)
+   
+ }
[1] "fold 1 of run 1"
[1] "fold 2 of run 1"
[1] "fold 3 of run 1"
[1] "fold 4 of run 1"
[1] "fold 5 of run 1"
[1] "fold 6 of run 1"
[1] "fold 7 of run 1"
[1] "fold 8 of run 1"
[1] "fold 9 of run 1"
[1] "fold 10 of run 1"
[1] 0.6961748
[1] "fold 1 of run 2"
[1] "fold 2 of run 2"
[1] "fold 3 of run 2"
[1] "fold 4 of run 2"
[1] "fold 5 of run 2"
[1] "fold 6 of run 2"
[1] "fold 7 of run 2"
[1] "fold 8 of run 2"
[1] "fold 9 of run 2"
[1] "fold 10 of run 2"
[1] 0.5
[1] "fold 1 of run 3"
[1] "fold 2 of run 3"
[1] "fold 3 of run 3"
[1] "fold 4 of run 3"
[1] "fold 5 of run 3"
[1] "fold 6 of run 3"
[1] "fold 7 of run 3"
[1] "fold 8 of run 3"
[1] "fold 9 of run 3"
[1] "fold 10 of run 3"
[1] 0.7416326
[1] "fold 1 of run 4"
[1] "fold 2 of run 4"
[1] "fold 3 of run 4"
[1] "fold 4 of run 4"
[1] "fold 5 of run 4"
[1] "fold 6 of run 4"
[1] "fold 7 of run 4"
[1] "fold 8 of run 4"
[1] "fold 9 of run 4"
[1] "fold 10 of run 4"
[1] 0.5759212
[1] "fold 1 of run 5"
[1] "fold 2 of run 5"
[1] "fold 3 of run 5"
[1] "fold 4 of run 5"
[1] "fold 5 of run 5"
[1] "fold 6 of run 5"
[1] "fold 7 of run 5"
[1] "fold 8 of run 5"
[1] "fold 9 of run 5"
[1] "fold 10 of run 5"
[1] 0.7298919
[1] "fold 1 of run 6"
[1] "fold 2 of run 6"
[1] "fold 3 of run 6"
[1] "fold 4 of run 6"
[1] "fold 5 of run 6"
[1] "fold 6 of run 6"
[1] "fold 7 of run 6"
[1] "fold 8 of run 6"
[1] "fold 9 of run 6"
[1] "fold 10 of run 6"
[1] 0.7713593
[1] "fold 1 of run 7"
[1] "fold 2 of run 7"
[1] "fold 3 of run 7"
[1] "fold 4 of run 7"
[1] "fold 5 of run 7"
[1] "fold 6 of run 7"
[1] "fold 7 of run 7"
[1] "fold 8 of run 7"
[1] "fold 9 of run 7"
[1] "fold 10 of run 7"
[1] 0.593531
[1] "fold 1 of run 8"
[1] "fold 2 of run 8"
[1] "fold 3 of run 8"
[1] "fold 4 of run 8"
[1] "fold 5 of run 8"
[1] "fold 6 of run 8"
[1] "fold 7 of run 8"
[1] "fold 8 of run 8"
[1] "fold 9 of run 8"
[1] "fold 10 of run 8"
[1] 0.7388033
[1] "fold 1 of run 9"
[1] "fold 2 of run 9"
[1] "fold 3 of run 9"
[1] "fold 4 of run 9"
[1] "fold 5 of run 9"
[1] "fold 6 of run 9"
[1] "fold 7 of run 9"
[1] "fold 8 of run 9"
[1] "fold 9 of run 9"
[1] "fold 10 of run 9"
[1] 0.8189826
[1] "fold 1 of run 10"
[1] "fold 2 of run 10"
[1] "fold 3 of run 10"
[1] "fold 4 of run 10"
[1] "fold 5 of run 10"
[1] "fold 6 of run 10"
[1] "fold 7 of run 10"
[1] "fold 8 of run 10"
[1] "fold 9 of run 10"
[1] "fold 10 of run 10"
[1] 0.5
[1] "fold 1 of run 11"
[1] "fold 2 of run 11"
[1] "fold 3 of run 11"
[1] "fold 4 of run 11"
[1] "fold 5 of run 11"
[1] "fold 6 of run 11"
[1] "fold 7 of run 11"
[1] "fold 8 of run 11"
[1] "fold 9 of run 11"
[1] "fold 10 of run 11"
[1] 0.5885945
[1] "fold 1 of run 12"
[1] "fold 2 of run 12"
[1] "fold 3 of run 12"
[1] "fold 4 of run 12"
[1] "fold 5 of run 12"
[1] "fold 6 of run 12"
[1] "fold 7 of run 12"
[1] "fold 8 of run 12"
[1] "fold 9 of run 12"
[1] "fold 10 of run 12"
[1] 0.7767813
[1] "fold 1 of run 13"
[1] "fold 2 of run 13"
[1] "fold 3 of run 13"
[1] "fold 4 of run 13"
[1] "fold 5 of run 13"
[1] "fold 6 of run 13"
[1] "fold 7 of run 13"
[1] "fold 8 of run 13"
[1] "fold 9 of run 13"
[1] "fold 10 of run 13"
[1] 0.5258697
[1] "fold 1 of run 14"
[1] "fold 2 of run 14"
[1] "fold 3 of run 14"
[1] "fold 4 of run 14"
[1] "fold 5 of run 14"
[1] "fold 6 of run 14"
[1] "fold 7 of run 14"
[1] "fold 8 of run 14"
[1] "fold 9 of run 14"
[1] "fold 10 of run 14"
[1] 0.6178277
[1] "fold 1 of run 15"
[1] "fold 2 of run 15"
[1] "fold 3 of run 15"
[1] "fold 4 of run 15"
[1] "fold 5 of run 15"
[1] "fold 6 of run 15"
[1] "fold 7 of run 15"
[1] "fold 8 of run 15"
[1] "fold 9 of run 15"
[1] "fold 10 of run 15"
[1] 0.5
[1] "fold 1 of run 16"
[1] "fold 2 of run 16"
[1] "fold 3 of run 16"
[1] "fold 4 of run 16"
[1] "fold 5 of run 16"
[1] "fold 6 of run 16"
[1] "fold 7 of run 16"
[1] "fold 8 of run 16"
[1] "fold 9 of run 16"
[1] "fold 10 of run 16"
[1] 0.6560594
[1] "fold 1 of run 17"
[1] "fold 2 of run 17"
[1] "fold 3 of run 17"
[1] "fold 4 of run 17"
[1] "fold 5 of run 17"
[1] "fold 6 of run 17"
[1] "fold 7 of run 17"
[1] "fold 8 of run 17"
[1] "fold 9 of run 17"
[1] "fold 10 of run 17"
[1] 0.5872118
[1] "fold 1 of run 18"
[1] "fold 2 of run 18"
[1] "fold 3 of run 18"
[1] "fold 4 of run 18"
[1] "fold 5 of run 18"
[1] "fold 6 of run 18"
[1] "fold 7 of run 18"
[1] "fold 8 of run 18"
[1] "fold 9 of run 18"
[1] "fold 10 of run 18"
[1] 0.5944937
[1] "fold 1 of run 19"
[1] "fold 2 of run 19"
[1] "fold 3 of run 19"
[1] "fold 4 of run 19"
[1] "fold 5 of run 19"
[1] "fold 6 of run 19"
[1] "fold 7 of run 19"
[1] "fold 8 of run 19"
[1] "fold 9 of run 19"
[1] "fold 10 of run 19"
[1] 0.7774695
[1] "fold 1 of run 20"
[1] "fold 2 of run 20"
[1] "fold 3 of run 20"
[1] "fold 4 of run 20"
[1] "fold 5 of run 20"
[1] "fold 6 of run 20"
[1] "fold 7 of run 20"
[1] "fold 8 of run 20"
[1] "fold 9 of run 20"
[1] "fold 10 of run 20"
[1] 0.5
[1] "fold 1 of run 21"
[1] "fold 2 of run 21"
[1] "fold 3 of run 21"
[1] "fold 4 of run 21"
[1] "fold 5 of run 21"
[1] "fold 6 of run 21"
[1] "fold 7 of run 21"
[1] "fold 8 of run 21"
[1] "fold 9 of run 21"
[1] "fold 10 of run 21"
[1] 0.5875307
[1] "fold 1 of run 22"
[1] "fold 2 of run 22"
[1] "fold 3 of run 22"
[1] "fold 4 of run 22"
[1] "fold 5 of run 22"
[1] "fold 6 of run 22"
[1] "fold 7 of run 22"
[1] "fold 8 of run 22"
[1] "fold 9 of run 22"
[1] "fold 10 of run 22"
[1] 0.6996724
[1] "fold 1 of run 23"
[1] "fold 2 of run 23"
[1] "fold 3 of run 23"
[1] "fold 4 of run 23"
[1] "fold 5 of run 23"
[1] "fold 6 of run 23"
[1] "fold 7 of run 23"
[1] "fold 8 of run 23"
[1] "fold 9 of run 23"
[1] "fold 10 of run 23"
[1] 0.5057655
[1] "fold 1 of run 24"
[1] "fold 2 of run 24"
[1] "fold 3 of run 24"
[1] "fold 4 of run 24"
[1] "fold 5 of run 24"
[1] "fold 6 of run 24"
[1] "fold 7 of run 24"
[1] "fold 8 of run 24"
[1] "fold 9 of run 24"
[1] "fold 10 of run 24"
[1] 0.8140408
[1] "fold 1 of run 25"
[1] "fold 2 of run 25"
[1] "fold 3 of run 25"
[1] "fold 4 of run 25"
[1] "fold 5 of run 25"
[1] "fold 6 of run 25"
[1] "fold 7 of run 25"
[1] "fold 8 of run 25"
[1] "fold 9 of run 25"
[1] "fold 10 of run 25"
[1] 0.7132032
[1] "fold 1 of run 26"
[1] "fold 2 of run 26"
[1] "fold 3 of run 26"
[1] "fold 4 of run 26"
[1] "fold 5 of run 26"
[1] "fold 6 of run 26"
[1] "fold 7 of run 26"
[1] "fold 8 of run 26"
[1] "fold 9 of run 26"
[1] "fold 10 of run 26"
[1] 0.5
[1] "fold 1 of run 27"
[1] "fold 2 of run 27"
[1] "fold 3 of run 27"
[1] "fold 4 of run 27"
[1] "fold 5 of run 27"
[1] "fold 6 of run 27"
[1] "fold 7 of run 27"
[1] "fold 8 of run 27"
[1] "fold 9 of run 27"
[1] "fold 10 of run 27"
[1] 0.6614076
[1] "fold 1 of run 28"
[1] "fold 2 of run 28"
[1] "fold 3 of run 28"
[1] "fold 4 of run 28"
[1] "fold 5 of run 28"
[1] "fold 6 of run 28"
[1] "fold 7 of run 28"
[1] "fold 8 of run 28"
[1] "fold 9 of run 28"
[1] "fold 10 of run 28"
[1] 0.5
[1] "fold 1 of run 29"
[1] "fold 2 of run 29"
[1] "fold 3 of run 29"
[1] "fold 4 of run 29"
[1] "fold 5 of run 29"
[1] "fold 6 of run 29"
[1] "fold 7 of run 29"
[1] "fold 8 of run 29"
[1] "fold 9 of run 29"
[1] "fold 10 of run 29"
[1] 0.5
[1] "fold 1 of run 30"
[1] "fold 2 of run 30"
[1] "fold 3 of run 30"
[1] "fold 4 of run 30"
[1] "fold 5 of run 30"
[1] "fold 6 of run 30"
[1] "fold 7 of run 30"
[1] "fold 8 of run 30"
[1] "fold 9 of run 30"
[1] "fold 10 of run 30"
[1] 0.5859365
[1] "fold 1 of run 31"
[1] "fold 2 of run 31"
[1] "fold 3 of run 31"
[1] "fold 4 of run 31"
[1] "fold 5 of run 31"
[1] "fold 6 of run 31"
[1] "fold 7 of run 31"
[1] "fold 8 of run 31"
[1] "fold 9 of run 31"
[1] "fold 10 of run 31"
[1] 0.5357543
[1] "fold 1 of run 32"
[1] "fold 2 of run 32"
[1] "fold 3 of run 32"
[1] "fold 4 of run 32"
[1] "fold 5 of run 32"
[1] "fold 6 of run 32"
[1] "fold 7 of run 32"
[1] "fold 8 of run 32"
[1] "fold 9 of run 32"
[1] "fold 10 of run 32"
[1] 0.5411113
> Sys.time()
[1] "2020-03-30 16:26:06 EDT"

print(summary(design.resp))
Call:
FrF2((2^(numFactors - n)), numFactors, factor.names = list(ntree = c(-1, 
    1), mtry = c(-1, 1), replace = c(-1, 1), nodesize = c(-1, 
    1), classwt = c(-1, 1), cutoff = c(-1, 1), maxnodes = c(-1, 
    1)), seed = 6285)

Experimental design of type  FrF2 
32  runs

Factor settings (scale ends):
  ntree mtry replace nodesize classwt cutoff maxnodes
1    -1   -1      -1       -1      -1     -1       -1
2     1    1       1        1       1      1        1

Responses:
[1] results5

Design generating information:
$legend
[1] A=ntree    B=mtry     C=replace  D=nodesize E=classwt  F=cutoff   G=maxnodes

$generators
[1] F=ABC  G=ABDE


Alias structure:
$fi2
[1] AB=CF AC=BF AF=BC


The design itself:
   ntree mtry replace nodesize classwt cutoff maxnodes  results5
1     -1    1      -1       -1       1      1        1 0.6961748
2      1   -1      -1        1      -1      1        1 0.5000000
3      1    1       1        1       1      1        1 0.7416326
4      1    1      -1        1       1     -1        1 0.5759212
5     -1    1      -1        1       1      1       -1 0.7298919
6      1   -1       1       -1       1     -1        1 0.7713593
7      1   -1       1        1      -1     -1        1 0.5935310
8     -1   -1       1        1       1      1        1 0.7388033
9     -1    1       1       -1       1     -1        1 0.8189826
10    -1    1      -1       -1      -1      1       -1 0.5000000
11    -1    1       1       -1      -1     -1       -1 0.5885945
12    -1   -1      -1       -1      -1     -1        1 0.7767813
13    -1   -1      -1        1       1     -1        1 0.5258697
14    -1   -1       1       -1      -1      1        1 0.6178277
15    -1   -1       1        1      -1      1       -1 0.5000000
16     1    1       1       -1      -1      1        1 0.6560594
17    -1   -1      -1        1      -1     -1       -1 0.5872118
18    -1    1       1        1      -1     -1        1 0.5944937
19     1   -1      -1       -1       1      1        1 0.7774695
20     1    1       1        1      -1      1       -1 0.5000000
21     1    1      -1        1      -1     -1       -1 0.5875307
22     1   -1      -1        1       1      1       -1 0.6996724
23    -1    1      -1        1      -1      1        1 0.5057655
24     1    1      -1       -1      -1     -1        1 0.8140408
25     1    1       1       -1       1      1       -1 0.7132032
26     1   -1       1        1       1     -1       -1 0.5000000
27    -1   -1       1       -1       1      1       -1 0.6614076
28    -1   -1      -1       -1       1     -1       -1 0.5000000
29     1   -1      -1       -1      -1      1       -1 0.5000000
30     1   -1       1       -1      -1     -1       -1 0.5859365
31     1    1      -1       -1       1     -1       -1 0.5357543
32    -1    1       1        1       1     -1       -1 0.5411113
class=design, type= FrF2 
NULL


print(summary(lm(design.resp)))
Number of observations used: 32 
Formula:
results5 ~ (ntree + mtry + replace + nodesize + classwt + cutoff + 
    maxnodes)^2

Call:
lm.default(formula = fo, data = model.frame(fo, data = formula))

Residuals:
      Min        1Q    Median        3Q       Max 
-0.023625 -0.006424  0.000000  0.006424  0.023625 

Coefficients: (3 not defined because of singularities)
                      Estimate Std. Error t value Pr(>|t|)    
(Intercept)          6.230e-01  4.313e-03 144.441 7.43e-12 ***
ntree1               5.287e-03  4.313e-03   1.226 0.266157    
mtry1                8.228e-03  4.313e-03   1.908 0.105047    
replace1             9.714e-03  4.313e-03   2.252 0.065229 .  
nodesize1           -3.413e-02  4.313e-03  -7.913 0.000216 ***
classwt1             3.498e-02  4.313e-03   8.111 0.000188 ***
cutoff1              4.400e-03  4.313e-03   1.020 0.347035    
maxnodes1            4.607e-02  4.313e-03  10.683 3.97e-05 ***
ntree1:mtry1         4.033e-03  4.313e-03   0.935 0.385814    
ntree1:replace1     -5.256e-03  4.313e-03  -1.219 0.268711    
ntree1:nodesize1    -6.841e-03  4.313e-03  -1.586 0.163797    
ntree1:classwt1      1.136e-03  4.313e-03   0.263 0.801086    
ntree1:cutoff1       3.348e-03  4.313e-03   0.776 0.467075    
ntree1:maxnodes1     4.420e-03  4.313e-03   1.025 0.344993    
mtry1:replace1              NA         NA      NA       NA    
mtry1:nodesize1     -2.404e-05  4.313e-03  -0.006 0.995734    
mtry1:classwt1       2.903e-03  4.313e-03   0.673 0.525962    
mtry1:cutoff1               NA         NA      NA       NA    
mtry1:maxnodes1     -1.888e-03  4.313e-03  -0.438 0.676821    
replace1:nodesize1  -9.858e-03  4.313e-03  -2.286 0.062322 .  
replace1:classwt1    1.814e-02  4.313e-03   4.207 0.005642 ** 
replace1:cutoff1            NA         NA      NA       NA    
replace1:maxnodes1   1.283e-02  4.313e-03   2.974 0.024824 *  
nodesize1:classwt1   7.789e-03  4.313e-03   1.806 0.120938    
nodesize1:cutoff1    2.123e-02  4.313e-03   4.923 0.002650 ** 
nodesize1:maxnodes1 -3.791e-02  4.313e-03  -8.790 0.000120 ***
classwt1:cutoff1     5.743e-02  4.313e-03  13.315 1.11e-05 ***
classwt1:maxnodes1   1.748e-03  4.313e-03   0.405 0.699267    
cutoff1:maxnodes1   -1.923e-02  4.313e-03  -4.458 0.004292 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.0244 on 6 degrees of freedom
Multiple R-squared:   0.99,	Adjusted R-squared:  0.9484 
F-statistic:  23.8 on 25 and 6 DF,  p-value: 0.0003724


model <- lm(design.resp)
> model
Number of observations used: 32 
Formula:
results5 ~ (ntree + mtry + replace + nodesize + classwt + cutoff + 
    maxnodes)^2

Call:
lm.default(formula = fo, data = model.frame(fo, data = formula))

Coefficients:
        (Intercept)               ntree1                mtry1             replace1  
          6.230e-01            5.287e-03            8.228e-03            9.714e-03  
          nodesize1             classwt1              cutoff1            maxnodes1  
         -3.413e-02            3.498e-02            4.400e-03            4.607e-02  
       ntree1:mtry1      ntree1:replace1     ntree1:nodesize1      ntree1:classwt1  
          4.033e-03           -5.256e-03           -6.841e-03            1.136e-03  
     ntree1:cutoff1     ntree1:maxnodes1      mtry1:nodesize1       mtry1:classwt1  
          3.348e-03            4.420e-03           -2.404e-05            2.903e-03  
    mtry1:maxnodes1   replace1:nodesize1    replace1:classwt1   replace1:maxnodes1  
         -1.888e-03           -9.858e-03            1.814e-02            1.283e-02  
 nodesize1:classwt1    nodesize1:cutoff1  nodesize1:maxnodes1     classwt1:cutoff1  
          7.789e-03            2.123e-02           -3.791e-02            5.743e-02  
 classwt1:maxnodes1    cutoff1:maxnodes1  
          1.748e-03           -1.923e-02  

> pr <- resid(model)/(1 - lm.influence(model)$hat)
PRESS <- sum(pr^2)
> PRESS
[1] 0.1015895